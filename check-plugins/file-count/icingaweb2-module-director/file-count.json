{
    "Command": {
        "cmd-check-file-count": {
            "arguments": {
                "--always-ok": {
                    "set_if": "$file_count_always_ok$"
                },
                "--critical": {
                    "value": "$file_count_critical$"
                },
                "--filename": {
                    "value": "$file_count_filename$"
                },
                "--only-dirs": {
                    "set_if": "$file_count_only_dirs$"
                },
                "--only-files": {
                    "set_if": "$file_count_only_files$"
                },
                "--password": {
                    "value": "$file_count_password$"
                },
                "--pattern": {
                    "value": "$file_count_pattern$"
                },
                "--timeout": {
                    "value": "$file_count_timeout$"
                },
                "--timerange": {
                    "value": "$file_count_timerange$"
                },
                "--url": {
                    "value": "$file_count_url$"
                },
                "--username": {
                    "value": "$file_count_username$"
                },
                "--warning": {
                    "value": "$file_count_warning$"
                }
            },
            "command": "/usr/lib64/nagios/plugins/file-count",
            "disabled": false,
            "fields": [
                {
                    "datafield_id": 1,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 2,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 3,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 4,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 5,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 6,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 7,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 8,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 9,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 10,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 11,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 12,
                    "is_required": "n",
                    "var_filter": null
                }
            ],
            "imports": [],
            "is_string": null,
            "methods_execute": "PluginCheck",
            "object_name": "cmd-check-file-count",
            "object_type": "object",
            "timeout": "10",
            "vars": {},
            "zone": null,
            "uuid": "6b8a8423-bd78-42d5-a912-c5ea940052bc"
        },
        "cmd-check-file-count-windows": {
            "arguments": {
                "--always-ok": {
                    "set_if": "$file_count_windows_always_ok$"
                },
                "--critical": {
                    "value": "$file_count_windows_critical$"
                },
                "--filename": {
                    "value": "$file_count_windows_filename$"
                },
                "--only-dirs": {
                    "set_if": "$file_count_windows_only_dirs$"
                },
                "--only-files": {
                    "set_if": "$file_count_windows_only_files$"
                },
                "--password": {
                    "value": "$file_count_windows_password$"
                },
                "--pattern": {
                    "value": "$file_count_windows_pattern$"
                },
                "--timeout": {
                    "value": "$file_count_windows_timeout$"
                },
                "--timerange": {
                    "value": "$file_count_windows_timerange$"
                },
                "--url": {
                    "value": "$file_count_windows_url$"
                },
                "--username": {
                    "value": "$file_count_windows_username$"
                },
                "--warning": {
                    "value": "$file_count_windows_warning$"
                }
            },
            "command": "C:\\Program Files\\icinga2\\sbin\\linuxfabrik\\file-count.exe",
            "disabled": false,
            "fields": [
                {
                    "datafield_id": 13,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 14,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 15,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 16,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 17,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 18,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 19,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 20,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 21,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 22,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 23,
                    "is_required": "n",
                    "var_filter": null
                },
                {
                    "datafield_id": 24,
                    "is_required": "n",
                    "var_filter": null
                }
            ],
            "imports": [],
            "is_string": null,
            "methods_execute": "PluginCheck",
            "object_name": "cmd-check-file-count-windows",
            "object_type": "object",
            "timeout": "10",
            "vars": {},
            "zone": null,
            "uuid": "d154f37f-daf5-41b1-aba8-f1f90f48b58f"
        },
        "cmd-check-file-count-windows-python": {
            "arguments": {},
            "command": "C:\\Windows\\py C:\\Program Files\\icinga2\\sbin\\linuxfabrik\\file-count.py",
            "disabled": false,
            "fields": [],
            "imports": [
                "cmd-check-file-count-windows"
            ],
            "is_string": null,
            "methods_execute": null,
            "object_name": "cmd-check-file-count-windows-python",
            "object_type": "object",
            "timeout": null,
            "vars": {},
            "zone": null,
            "uuid": "20f2fff8-607f-445f-826f-eb957244726d"
        }
    },
    "ServiceTemplate": {
        "tpl-service-file-count": {
            "action_url": null,
            "apply_for": null,
            "assign_filter": null,
            "check_command": "cmd-check-file-count",
            "check_interval": 60,
            "check_period": null,
            "check_timeout": null,
            "command_endpoint": null,
            "disabled": false,
            "display_name": null,
            "enable_active_checks": null,
            "enable_event_handler": null,
            "enable_flapping": null,
            "enable_notifications": true,
            "enable_passive_checks": null,
            "enable_perfdata": true,
            "event_command": null,
            "fields": [],
            "flapping_threshold_high": null,
            "flapping_threshold_low": null,
            "groups": [],
            "host": null,
            "icon_image": "file-count.svg",
            "icon_image_alt": null,
            "imports": [
                "tpl-service-generic"
            ],
            "max_check_attempts": 5,
            "notes": "Checks the number of matching files.",
            "notes_url": "https://github.com/Linuxfabrik/monitoring-plugins/tree/main/check-plugins/file-count",
            "object_name": "tpl-service-file-count",
            "object_type": "template",
            "retry_interval": 15,
            "service_set": null,
            "template_choice": null,
            "use_agent": null,
            "use_var_overrides": null,
            "vars": {
                "criticality": "C",
                "file_count_always_ok": false,
                "file_count_only_dirs": false,
                "file_count_only_files": false,
                "file_count_pattern": "*",
                "file_count_timeout": 3
            },
            "volatile": null,
            "zone": null,
            "uuid": "1e20297e-b577-4ebf-ba41-fed331d3a228"
        },
        "tpl-service-file-count-windows": {
            "action_url": null,
            "apply_for": null,
            "assign_filter": null,
            "check_command": "cmd-check-file-count-windows",
            "check_interval": 60,
            "check_period": null,
            "check_timeout": null,
            "command_endpoint": null,
            "disabled": false,
            "display_name": null,
            "enable_active_checks": null,
            "enable_event_handler": null,
            "enable_flapping": null,
            "enable_notifications": true,
            "enable_passive_checks": null,
            "enable_perfdata": true,
            "event_command": null,
            "fields": [],
            "flapping_threshold_high": null,
            "flapping_threshold_low": null,
            "groups": [],
            "host": null,
            "icon_image": "file-count.svg",
            "icon_image_alt": null,
            "imports": [
                "tpl-service-generic"
            ],
            "max_check_attempts": 5,
            "notes": "Checks the number of matching files.",
            "notes_url": "https://github.com/Linuxfabrik/monitoring-plugins/tree/main/check-plugins/file-count",
            "object_name": "tpl-service-file-count-windows",
            "object_type": "template",
            "retry_interval": 15,
            "service_set": null,
            "template_choice": null,
            "use_agent": null,
            "use_var_overrides": null,
            "vars": {
                "criticality": "C",
                "file_count_windows_always_ok": false,
                "file_count_windows_only_dirs": false,
                "file_count_windows_only_files": false,
                "file_count_windows_pattern": "*",
                "file_count_windows_timeout": 3
            },
            "volatile": null,
            "zone": null,
            "uuid": "e5aa8d98-7b38-4fc2-8da6-759b7f0d4c0b"
        }
    },
    "Datafield": {
        "1": {
            "varname": "file_count_always_ok",
            "caption": "File Count: Always OK?",
            "description": "Always returns OK.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "5ae74ae0-79a0-469d-b133-bdc0855456b3"
        },
        "2": {
            "varname": "file_count_critical",
            "caption": "File Count: Critical",
            "description": "Set the critical number of files. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "3ae1fcf5-46e2-4b63-80af-7a99a7f682b9"
        },
        "3": {
            "varname": "file_count_filename",
            "caption": "File Count: Filename",
            "description": "File (or directory) name to check. Supports glob in accordance with https://docs.python.org/3/library/pathlib.html#pathlib.Path.glob. Beware of using recursive globs. This is mutually exclusive with -u / --url.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "b6e8c469-7870-4615-9849-84a07dd391f5"
        },
        "4": {
            "varname": "file_count_only_dirs",
            "caption": "File Count: Only Dirs?",
            "description": "Only consider directories.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "98bbce6e-1d74-4747-9247-9556a452c252"
        },
        "5": {
            "varname": "file_count_only_files",
            "caption": "File Count: Only Files?",
            "description": "Only consider files.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "a30a1bd6-2d96-45fd-97a7-c30e6dd59b94"
        },
        "6": {
            "varname": "file_count_password",
            "caption": "File Count: Password",
            "description": "SMB Password.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "hidden"
            },
            "uuid": "c8ca767d-3c2e-4d2e-b9ed-ca5bd382cf9c"
        },
        "7": {
            "varname": "file_count_pattern",
            "caption": "File Count: Pattern",
            "description": "The search string to match against the names of SMB directories or files. This pattern can use '*' as a wildcard for multiple chars and '?' as a wildcard for a single char. Does not support regex patterns.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "9603a7e5-9228-44e8-9730-748c81189bdf"
        },
        "8": {
            "varname": "file_count_timeout",
            "caption": "File Count: Timeout",
            "description": "Network timeout in seconds.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "ae2651aa-dd9a-46fb-949e-8623ddd2f5e0"
        },
        "9": {
            "varname": "file_count_timerange",
            "caption": "File Count: Timerange",
            "description": "Set the timerange (seconds) in which the files should be considered. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "40d05977-427f-4a2a-9ac3-e075d556a6b3"
        },
        "10": {
            "varname": "file_count_url",
            "caption": "File Count: URL",
            "description": "Set the url of the file (or directory) to check, starting with \"smb://\". This is mutually exclusive with --filename.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "08d6c17d-840a-4271-bab7-ef85beb4d791"
        },
        "11": {
            "varname": "file_count_username",
            "caption": "File Count: Username",
            "description": "SMB Username.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "c059cd14-d8f4-4df4-9c8b-da1bb2e3c065"
        },
        "12": {
            "varname": "file_count_warning",
            "caption": "File Count: Warning",
            "description": "Set the warning number of files. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "edbb8a9d-4740-4a8b-9395-dc30cfdb324f"
        },
        "13": {
            "varname": "file_count_windows_always_ok",
            "caption": "File Count: Always OK?",
            "description": "Always returns OK.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "5e3390f1-9b6b-4a0b-bd5e-dc226d6b6621"
        },
        "14": {
            "varname": "file_count_windows_critical",
            "caption": "File Count: Critical",
            "description": "Set the critical number of files. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "9fbc8fcc-a263-4f13-83c3-883901a0c2d0"
        },
        "15": {
            "varname": "file_count_windows_filename",
            "caption": "File Count: Filename",
            "description": "File (or directory) name to check. Supports glob in accordance with https://docs.python.org/3/library/pathlib.html#pathlib.Path.glob. Beware of using recursive globs. This is mutually exclusive with -u / --url.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "ac51d01f-8df6-476e-b237-dda6d857354b"
        },
        "16": {
            "varname": "file_count_windows_only_dirs",
            "caption": "File Count: Only Dirs?",
            "description": "Only consider directories.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "a2b3d3d5-1f9a-4692-99e9-b2e5ddf6fec3"
        },
        "17": {
            "varname": "file_count_windows_only_files",
            "caption": "File Count: Only Files?",
            "description": "Only consider files.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeBoolean",
            "format": null,
            "settings": {},
            "uuid": "8726e04a-309a-4c74-aa3c-176bb4a3ab19"
        },
        "18": {
            "varname": "file_count_windows_password",
            "caption": "File Count: Password",
            "description": "SMB Password.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "hidden"
            },
            "uuid": "0812e839-9429-4b4b-9eb6-99bb887ff673"
        },
        "19": {
            "varname": "file_count_windows_pattern",
            "caption": "File Count: Pattern",
            "description": "The search string to match against the names of SMB directories or files. This pattern can use '*' as a wildcard for multiple chars and '?' as a wildcard for a single char. Does not support regex patterns.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "022a77a9-05f2-4ba1-966a-f045537c182a"
        },
        "20": {
            "varname": "file_count_windows_timeout",
            "caption": "File Count: Timeout",
            "description": "Network timeout in seconds.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "e7b9aff3-be60-4e3f-ba0f-24b946d9e922"
        },
        "21": {
            "varname": "file_count_windows_timerange",
            "caption": "File Count: Timerange",
            "description": "Set the timerange (seconds) in which the files should be considered. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "e3c45915-ff0c-4fb6-a427-08f884b1cc72"
        },
        "22": {
            "varname": "file_count_windows_url",
            "caption": "File Count: URL",
            "description": "Set the url of the file (or directory) to check, starting with \"smb://\". This is mutually exclusive with --filename.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "f924d256-727b-4d4a-93e9-eaa63c607098"
        },
        "23": {
            "varname": "file_count_windows_username",
            "caption": "File Count: Username",
            "description": "SMB Username.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "d91d122d-d746-4b9b-bd84-a1951929000a"
        },
        "24": {
            "varname": "file_count_windows_warning",
            "caption": "File Count: Warning",
            "description": "Set the warning number of files. Supports ranges.",
            "datatype": "Icinga\\Module\\Director\\DataType\\DataTypeString",
            "format": null,
            "settings": {
                "visibility": "visible"
            },
            "uuid": "1246c178-e92d-4866-baf5-da2acdcab14b"
        }
    }
}
